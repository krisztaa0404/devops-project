events {
    worker_connections 1024;
}

http {
    # Main landing page
    server {
        listen 80;
        server_name devops-project.test;

        location / {
            return 200 '<!DOCTYPE html>
<html><head><title>DevOps Project</title></head><body>
<h1>DevOps Project Services</h1>
<ul>
<li><a href="http://grafana.devops-project.test">Grafana</a> (or <a href="http://localhost:3001">localhost:3001</a>)</li>
<li><a href="http://prometheus.devops-project.test">Prometheus</a> (or <a href="http://localhost:9090">localhost:9090</a>)</li>
<li><a href="http://kibana.devops-project.test">Kibana</a> (or <a href="http://localhost:5601">localhost:5601</a>)</li>
</ul>
</body></html>';
            add_header Content-Type text/html;
        }
    }

    # Grafana subdomain
    server {
        listen 80;
        server_name grafana.devops-project.test;

        location / {
            proxy_pass http://grafana:3000;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }

    # Prometheus subdomain
    server {
        listen 80;
        server_name prometheus.devops-project.test;

        location / {
            proxy_pass http://prometheus:9090;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }

    # Kibana subdomain
    server {
        listen 80;
        server_name kibana.devops-project.test;

        location / {
            proxy_pass http://kibana:5601;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}